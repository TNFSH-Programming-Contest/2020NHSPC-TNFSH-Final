# 露營

\begin{figure}[h]
\centering
\includegraphics[width=5in]{img.jpg}
\caption{撫子、葵和千明參與集章活動，出自動畫《房間露營》}
\end{figure}

撫子、葵和千明參加了地方政府舉辦的集章活動。  
這個集章活動由政府推薦了 $N$ 個景點，還有 $M$ 個「下一個景點」建議，推薦你參訪過某個景點後，接下來適合前往哪些景點（可能有些景點沒有「下一個景點」建議）。  
為了避免遊客參訪重複的景點，如果 $A$ 景點的「下一個景點」有 $B$ 景點，那麼 $B$ 景點的「下一個景點」就不會有 $A$ 景點，  
同時確實遵守「下一個景點」建議的話，也不會在經過數個景點後走到曾經走過的景點。  
集章活動有特殊的獎勵規則，每個集章景點都有代號 $v_i$，有些代號會重複，  
從任何一個景點開始，並確實遵照「下一個景點」建議收集印章，且景點代號序列形成「回文」（也就是從左到右依序念出每個代號，會跟從右到左相同），  
就能獲得一份神秘禮物，當然只參訪一個景點也算是回文，但是禮物就只有衛生紙而已。  
現在請問有多少種參訪方式能獲得神秘禮物，答案很大請 $\text{mod}~(10^9 + 7)$。  

\clearpage

## 輸入
第一行有兩個整數 $N,~M$，  
第二行有 $N$ 個整數 $v_i$，代表景點 $i$ 的代號為 $v_i$，  
接下來 $N$ 行中，每行有 $N$ 個整數，  
這 $N$ 行中的第 $i$ 行的第 $j$ 個數字為 $E_{ij}$，若 $E_{ij} = 1$ 代表景點 $i$ 的「下一個景點」建議中有景點 $j$，$E_{ij} = 0$ 則代表沒有。  

## 輸出
輸出一個整數，代表有多少種參訪方式能獲得神秘禮物，答案很大請 $\text{mod} (10^9 + 7)$。  

## 輸入限制
 - $1 \leq N \leq 1000$
 - $1 \leq M \leq 3000$
 - $1 \leq v_i \leq 1000$

## 子任務
\subtasks

\clearpage

## 範例輸入1
```
5 4
1 1 2 1 3
0 1 1 0 0
0 0 0 0 0
0 0 0 1 1
0 0 0 0 0
0 0 0 0 0
```

## 範例輸出1
```
7
```

## 範例輸入2
```
5 5
1 2 2 1 2
0 1 0 0 1
0 0 0 0 1
1 0 0 0 0
0 0 0 0 0
0 0 0 1 0
```

## 範例輸出2
```
10
```
